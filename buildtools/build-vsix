#!/usr/bin/env bash

export DOTNET_NOLOGO=true
SEMVER=`buildtools/versionize`
VERSIONTYPE=`buildtools/versionize type`
VSIX_FILENAME="artifacts/shebang-snippets-$SEMVER.vsix"

mkdir ./artifacts

npm version --git-tag-version false --allow-same-version true -- $SEMVER
if [[ "$VERSIONTYPE" == "preview" ]]; then
   npm pkg set preview='true'
fi
pnpm install
pnpm run build:vsix -o $VSIX_FILENAME
